/* =============================================================
    // Mutli-screen flat 3D analogue clock (V2.7) with jQuery & CSS3 - No image, no webGL
    // By molokoloco@gmail.com 05/2013
    
    // Demo : http://molokoloco.github.io/flatClock3d/
    // GitHub sources : https://github.com/molokoloco/flatClock3d
    // Documentation : http://tinyurl.com/flatclock3d
    // Blog post : http://www.b2bweb.fr/coding-project/mutli-screen-flat-3d-analogue-clock-with-jquery-and-css3-v2-3/
    // jsFiddle 2D : http://jsfiddle.net/molokoloco/V2rFN/
    // jsFiddle + 3D : http://jsfiddle.net/molokoloco/x6yc3/
* ============================================================== */

!function(f){f.fn.extend({circalise:function(b){b=f.extend({targets:"> *",rotateTargets:!1,rotate3d:!1,startAngle:270,xRadius:null,yRadius:null},b||{});return this.each(function(){var a=f(this),h=parseInt(a.outerWidth(),10),c=parseInt(a.outerHeight(),10),m=a.find(b.targets),n=2*Math.PI/m.length,k=Math.PI*(b.startAngle/180);m.each(function(){var a=f(this),g=(h-parseInt(a.outerWidth(),10))/2,e=(c-parseInt(a.outerHeight(),10))/2,d=b.yRadius||0===b.yRadius?b.yRadius:e,d={left:(b.xRadius||0===b.xRadius?
b.xRadius:g)*Math.cos(k)+g,top:d*Math.sin(k)+e};if(b.rotateTargets||b.rotate3d)g=Math.atan2(d.top-e,d.left-g)+Math.PI/2,/e-/.test(g+"")&&(g=0),d.transform=b.rotate3d?"translate("+d.left+"px, "+d.top+"px) rotateX(90deg) rotateY("+g+"rad)":"translate("+d.left+"px, "+d.top+"px) rotate("+g+"rad)",delete d.left,delete d.top;a.css(d);k+=n});return a})},analogueClock:function(b){b=f.extend({withHours:!0,rotateHours:!0,withUnits:!0,withDigitalTime:!1,withDate:!1},b||{});return this.each(function(){var a=
f(this),h=a.width(),c=a.height(),h=h/2,m=f('<div class="sec"><div class="clockwise"></div></div>').appendTo(a),n=f('<div class="min"><div class="clockwise"></div></div>').appendTo(a),k=f('<div class="hour"><div class="clockwise"></div></div>').appendTo(a),q=b.withDigitalTime?f('<div class="time"></div>').appendTo(a):null,g=b.withDate?f('<div class="date"></div>').appendTo(a):null,e=f('<div class="innerCenter"></div>').appendTo(a);m.css({left:h-parseInt(m.width(),10)/2+"px",height:c+"px"});n.css({left:h-
parseInt(n.width(),10)/2+"px",height:c+"px"});k.css({left:h-parseInt(k.width(),10)/2+"px",height:c+"px"});e.css({margin:"-"+parseInt(e.height(),10)/2+"px 0 0 -"+parseInt(e.width(),10)/2+"px"});if(b.withHours){for(var d=12,l="",c=0;c<d;c++)l+='<div class="digit">'+(0==c%3?"<span>"+(0==c?d:c)+"</span>":c)+"</div>";a.append(l);a.circalise({targets:"div.digit",rotateTargets:b.rotateHours})}if(b.withUnits){d=12;l="";for(c=0;c<d;c++)l+='<div class="unit"></div>';a.append(l);c=parseInt(e.width(),10)/2-parseInt(a.find("div.unit").eq(0).outerHeight(),
10)/2;e=parseInt(e.height(),10)/2-parseInt(a.find("div.unit").eq(0).outerHeight(),10)/2;a.circalise({targets:".unit",rotateTargets:!0,xRadius:c,yRadius:e})}if(Modernizr.csstransforms3d){e="";for(c=0;50>c;c++)e+='<div class="side"></div>';f('<div id="clockBorder"/>').append(e).appendTo(a.parent()).circalise({targets:".side",rotate3d:!0,startAngle:0,xRadius:h,yRadius:h})}var p=function(){var a=new Date,c=a.getSeconds(),d=a.getMinutes(),e=a.getHours();m.css({transform:"rotate("+6*c+"deg)"});n.css({transform:"rotate("+
6*d+"deg)"});k.css({transform:"rotate("+(30*e+d/2)+"deg)"});b.withDate&&g.html(a.toString().split(a.getFullYear())[0]);b.withDigitalTime&&q.html(a.toString().split(a.getFullYear())[1].split(" ")[1]);setTimeout(p,300)};p();return a})}})}(window.jQuery);