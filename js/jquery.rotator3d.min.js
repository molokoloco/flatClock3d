/* =============================================================
    // Mutli-screen flat 3D analogue clock (V2.7) with jQuery & CSS3 - No image, no webGL
    // By molokoloco@gmail.com 05/2013
    
    // Demo : http://molokoloco.github.io/flatClock3d/
    // GitHub sources : https://github.com/molokoloco/flatClock3d
    // Documentation : http://tinyurl.com/flatclock3d
    // Blog post : http://www.b2bweb.fr/coding-project/mutli-screen-flat-3d-analogue-clock-with-jquery-and-css3-v2-3/
    // jsFiddle 2D : http://jsfiddle.net/molokoloco/V2rFN/
    // jsFiddle + 3D : http://jsfiddle.net/molokoloco/x6yc3/
* ============================================================== */

!function(b,d){var f=function(a,g){this.settings=b.extend(!0,{},b.fn.rotator3d.defaults,"object"==typeof g&&g||{});this.element=a;this.shadow=this.settings.shadow;this.reflet=this.settings.reflet;this.refletBack=this.settings.refletBack;this.newRotationX=this.settings.rotationX;this.newRotationY=this.settings.rotationY;this.winH=this.winW=this.currentRotationY=this.currentRotationX=0;this.paused=!1;var c=this,e=b(d);b(d).on("resize",function(){c.winW=e.width();c.winH=e.height()}).trigger("resize");
d.isMobile&&d.addEventListener("deviceorientation",function(a){if(c.settings.moveMouseEnabled&&c.settings.is3D){var b=a.beta;a=a.gamma;c.newRotationY=d.isMozMobile?a:-a;c.newRotationX=d.isMozMobile?-b:b}},!1);var f=function(a){c.settings.moveMouseEnabled&&c.settings.is3D&&(a.preventDefault(),c.newRotationY=0.15*(a.pageX-0.5*c.winW),c.newRotationX=0.5*-(a.pageY-0.5*c.winH))};b(document).mouseenter(function(a){c.settings.is3D&&c.settings.moveMouseEnabled&&(c.paused=!1,c.update(),document.addEventListener("pointermove",
f,!1))}).mouseleave(function(a){document.removeEventListener("pointermove",f,!1);c.paused=!0;c.refresh()}).trigger("mouseenter");c.refresh();c.update()};f.prototype={constructor:f,limitRotationValue:function(a,b,c){a<=b?a+=360:a>c&&(a-=360);return a=Math.min(Math.max(parseInt(a),b),c)},rotate3d:function(a,b){this.element.css({rotateX:a,rotateY:b});this.shadow&&this.shadow.css({rotateX:a-180,rotateY:b-180});this.reflet&&this.reflet.css({backgroundPosition:-5*this.limitRotationValue(b,-180,180)+"px "+
-1*this.limitRotationValue(a,-180,180)+"px"});this.refletBack&&this.refletBack.css({backgroundPosition:5*this.limitRotationValue(b,-180,180)+"px "+this.limitRotationValue(a,-180,180)+"px"})},refresh:function(){this.rotate3d(this.settings.rotationX,this.settings.rotationY)},update:function(){if(this.settings.moveMouseEnabled&&this.settings.is3D&&!this.paused){if(parseInt(10*this.currentRotationY)!=parseInt(10*this.newRotationY)||parseInt(10*this.currentRotationX)!=parseInt(10*this.newRotationX))this.currentRotationX+=
0.1*(this.newRotationX-this.currentRotationX),this.currentRotationY+=0.1*(this.newRotationY-this.currentRotationY),this.rotate3d(this.currentRotationX,this.currentRotationY);d.requestAnimationFrame(this.update.bind(this))}},presets:function(a){a&&a in b.fn.rotator3d.views?(this.settings.moveMouseEnabled=!1,this.rotate3d(b.fn.rotator3d.views[a].x,b.fn.rotator3d.views[a].y)):(this.settings.moveMouseEnabled=!0,this.update())},toggle3d:function(){this.settings.is3D?(this.settings.is3D=!1,this.settings.moveMouseEnabled=
!1,this.element.css({rotateX:0,rotateY:0}),this.shadow&&this.shadow.hide()):(this.settings.is3D=!0,this.settings.moveMouseEnabled=!0,this.shadow&&this.shadow.show(),this.update())}};var h=b.fn.rotator3d;b.fn.rotator3d=function(a,d){return this.each(function(){var c=b(this),e=c.data("rotator3d");e||c.data("rotator3d",e=new f(c,a));if("string"==typeof a)if(d)e[a](d);else e[a]()})};b.fn.rotator3d.Constructor=f;b.fn.rotator3d.defaults={shadow:null,reflet:null,refletBack:null,is3D:!0,moveMouseEnabled:!0,
rotationX:0,rotationY:0};b.fn.rotator3d.views={front:{x:0,y:0},back:{x:0,y:180},appleFront:{x:0,y:-30},appleBack:{x:0,y:-140},frontFloor:{x:0,y:90},backFloor:{x:0,y:-90},sideRight:{x:-90,y:0},sideLeft:{x:90,y:0},squareRoot:{x:45,y:45}};b.fn.rotator3d.noConflict=function(){b.fn.rotator3d=h;return this};b(d).on("load",function(){b('[data-rotator3d="true"]').each(function(){var a=b(this);a.rotator3d(a.data())})})}(window.jQuery,window);